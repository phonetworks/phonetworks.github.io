<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Phở Networks</title>

        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/font-awesome.min.css">
        <link rel="stylesheet" href="/css/highlight.dark.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="/">
                Phở Networks
                <small class="hidden-xs hidden-sm">
                    A modern framework for your next social-enabled app
                </small>
            </a>

                            <a href="https://github.com/phonetworks/">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                        <ul class="nav nav-pills nav-stacked">
                                                            <li class="">
                                    <a href="/">
                                        Overview
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/features.html">
                                        Features
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/projects.html">
                                        Projects
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/getting-started.html">
                                        Getting Started
                                    </a>
                                </li>
                                                            <li class="active">
                                    <a href="/reference.html">
                                        Reference
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/api/index.html">
                                        API
                                    </a>
                                </li>
                                                    </ul>

                    </nav>

                
                <section id="content" class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h2 id="introduction">Introduction</h2>
<p>Phở Kernel is the core of the Phở Networks stack. Written in PHP7, it is a programmable interface, as well as a configuration, events broker for distributed micro social graphs.</p>
<p>Phở Kernel is <strong>not</strong> static, which means you can run multiple kernel instances in a thread, and you can halt and reboot each thread as many times as needed.</p>
<p>Once you install <a href="https://github.com/phonetworks/pho-kernel">pho-kernel</a>, If you have PHP 7.1+ installed on your system, you can play with Phở Kernel right away, by typing <code>php -a</code> in the <code>examples/</code> directory of the pho-kernel repository, and including the index.php <code>include("index.php")</code> Although there are easier ways as well using CLI and you can intera</p>
<pre><code class="language-php">include("vendor/autoload.php");
$configs = array(
    "services"=&gt;array(
        "database" =&gt; "redis://127.0.0.1:6379",
        "storage" =&gt; "filesystem:// /tmp"
    )
);
$kernel = new Pho\Kernel\Kernel($configs);
$kernel-&gt;boot();
$network = $kernel-&gt;graph();
$founder = $kernel-&gt;founder();
array_walk($network-&gt;members(), function($key, $item) {
  printf("A %s node with id: %s", get_class($item), $item-&gt;id());
});</code></pre>
<h2 id="installation">Installation</h2>
<p>! TODO !</p>
<h2 id="core-concepts">Core Concepts</h2>
<p>Pho Kernel is a tool that facilitates your (as a programmer) management of social graphs. Just like any other <a href="https://en.wikipedia.org/wiki/Graph_theory">graph</a>, it is formed by &quot;nodes&quot; and their relationships identified by &quot;edges&quot;.</p>
<p>In <a href="https://en.wikipedia.org/wiki/Social_network">social networks</a>, there are three type of entities:</p>
<ul>
<li>Graphs</li>
<li>Actors</li>
<li>Objects</li>
</ul>
<p>Each of these nodes can have a particular set of edges. For example, Graphs &quot;contain&quot;, so they have the Contain edges.  Actors create and subscribe, so they have Create and Subscribe edges. Objects transmit, so they have Transmit edge.</p>
<p>Both edges and nodes are represented in the database with a universally unique identifier in the form of: &quot;aa406464-8508-49e9-b13a-c38d0a67c157&quot;. At Pho-Kernel, we use a cryptographically secure <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29">UUIDv4</a> generator to avoid collisions.</p>
<p>Overall, the picture below illustrates a mini social network, inspired by the movie <a href="https://en.wikipedia.org/wiki/The_Matrix">Matrix</a> where <strong>nodes</strong> are represented by:</p>
<ul>
<li>Squares =&gt; Graph,</li>
<li>Triangles =&gt; Actor,</li>
<li>Circles =&gt; Object</li>
</ul>
<p>and <strong>edges</strong> by arrows. The color of the arrow defines the Edge type;</p>
<ul>
<li>Blue =&gt; Transmits,</li>
<li>Black =&gt; Creates,</li>
<li>Red =&gt; Contains,</li>
<li>Green =&gt; Subscribes</li>
</ul>
<p><img src="img/Matrix.png" alt="Matrix movie social network" /></p>
<p>This tiny social network consists of:</p>
<ul>
<li>5 characters (aka Actor): Neo, Morpheus, Trinity, Agent Smith and Spoon Boy.</li>
<li>2 graphs: Matrix (the network itself) and a group called Resistance Hovercraft, created by Morpheus.</li>
<li>4 objects:
<ul>
<li>&quot;Everything begins with a choice&quot; a status update by Morpheus transmitted to the Matrix network,</li>
<li>&quot;Resistance is futile&quot; a comment by Agent Smith in response to Morpheus' blog post,</li>
<li>&quot;We must save Morpheus&quot; a blog post by Neo transmitted to the Resistance Hovercraft group after Agent Smith captures Morpheus,</li>
<li>and &quot;Kiss me&quot; a private message by Trinity transmitted to Neo before she dies.</li>
</ul></li>
</ul>
<h2 id="configuration">Configuration</h2>
<p>The list of all the configuration variables you can play with can be found in pho-microkernel's <a href="https://github.com/phonetworks/pho-microkernel/blob/master/src/Pho/Kernel/defaults.php">defaults.php</a> file.</p>
<pre><code class="language-php">array(
      "services" =&gt; array( // Services: type defines the adapter to use, and uri the service options.
          "database" =&gt; "apcu:", // ["type"=&gt;"apcu", "uri"=&gt; "" ],
          "logger" =&gt; "stdout:", // ["type"=&gt;"stdout", "uri"=&gt; "" ],
          "storage" =&gt; "filesystem:", // ["type"=&gt;"filesystem", "uri"=&gt; "" ],
          "events" =&gt; "local:", // ["type"=&gt;"local", "uri"=&gt; "" ]
      ),
      "tmp_path" =&gt; sys_get_temp_dir(), // Temporary folder to store files. For example uploaded files may go there.
      "root_path" =&gt; __DIR__,
      "adapter_path" =&gt; __DIR__ . DIRECTORY_SEPARATOR ." Services" . DIRECTORY_SEPARATOR . "Adapters",
      "namespaces" =&gt; array(
          "root" =&gt; __NAMESPACE__,
          "predicates" =&gt; __NAMESPACE__."\\Predicates\\",
          "services" =&gt; __NAMESPACE__."\\Services\\",
          "nodes" =&gt; __NAMESPACE__."\\Nodes\\",
          "edges" =&gt; __NAMESPACE__."\\Edges\\",
      ),
      "log_level" =&gt; "WARNING", // INFO
      "database_key_separator" =&gt; "/",
      "default_objects" =&gt; array(
        "graph" =&gt; Standards\Graph::class,
        "founder" =&gt; Standards\Founder::class,
        "space" =&gt; Standards\Space::class,
        "editors" =&gt; Standards\VirtualGraph::class
      )
);</code></pre>
<h2 id="kernel-methods">Kernel Methods</h2>
<p>Once you create the kernel object, you need to boot it up with:</p>
<pre><code class="language-php">$kernel-&gt;boot();</code></pre>
<p>Or if you have a custom founder (based on a non-standard Actor object) and you're running the kernel for the first time, you should pass it here:</p>
<pre><code class="language-php">$kernel-&gt;boot($founder);</code></pre>
<p>If this is not the first time the kernel is booted up, the argument will be ignored.</p>
<p>Once the kernel is booted up, you can query the outer and inner graphs as follows:</p>
<pre><code>$space = $kernel-&gt;space(); // returns the outer graph.
$graph = $kernel-&gt;graph(); // returns the actual graph that all your nodes will become part of.</code></pre>
<p>The outer graph, or &quot;space&quot; is a super-graph that has one and only one element, that is the graph.</p>
<p>To create a node in the graph, you just need to create the object by passing the kernel ($kernel) as its first argument. By default:</p>
<ul>
<li>Actor objects have two constructor variables; $kernel and $context (must implement \Pho\Framework\ContextInterface, for example: $kernel-&gt;space() which is the outer graph or $kernel-&gt;graph() which is the inner graph)</li>
<li>Object and Graph nodes are three constructor variables; $kernel, $context and $creator (which is an Actor object, the creator of this object)</li>
</ul>
<p>Please note, while this is a valid way to create nodes, it is not advised, unless you're creating Actor nodes. Under normal circumstances, you'll create nodes via formative edges, which we will see later.</p>
<p>To query a node, you just use the kernel's <code>gs()</code> method, which is similar to UNIX' filesystem. You must know the ID of the node.</p>
<p>To retrieve a node with the given id:</p>
<pre><code class="language-php">$node = $kernel-&gt;gs()-&gt;node("aa406464-8508-49e9-b13a-c38d0a67c157");</code></pre>
<p>Similarly, you can retrieve an edge with its ID using <code>$kernel-&gt;gs()-&gt;edge("edge-id")</code></p>
<h2 id="nodes">Nodes</h2>
<p>The default Pho Kernel node hierarchy, which is based on the AGO model is as follows:</p>
<p>&nbsp;</p>
<p><img src="img/NodeHierarchy.png" alt="Node Hierarchy" /></p>
<p>&nbsp;</p>
<p>For more information on the basics of working with nodes and edges, check out:</p>
<ul>
<li><a href="https://github.com/phonetworks/pho-lib-graph/tree/master/docs">Lib-Graph Documentation</a></li>
<li><a href="https://github.com/phonetworks/pho-framework/tree/master/docs">Framework Documentation</a></li>
</ul>
<p>Three types of nodes (actors, graphs and objects) can be summarized as follows:</p>
<h4 id="graphs">Graphs</h4>
<p>Graphs contain other nodes. This is their one and only function. A social network itself is a Graph. We call it the &quot;Network&quot;. Another typical type of Graph that most social networks have is Groups. </p>
<h4 id="actors">Actors</h4>
<p>Actors can do three things;</p>
<ol>
<li>Read</li>
<li>Write (forming new objects or editing them)</li>
<li>Subscribe (to get Notification from nodes)</li>
</ol>
<p>In social network context, social network members are the Actors. To illustrate this, take the example of Facebook. Facebook itself is a Graph. The groups and friend lists on Facebook are also Graphs (micro graphs). And you, as a Facebook member or the pages you own are Actors, because they like (subscribe) and respond (write) objects.</p>
<h4 id="objects">Objects</h4>
<p>Objects are what social networks are centered around. They are the fundamental units of sharing. A photo or status update can be examples of object. The only edge that originates from Objects is Edge, which does the exact opposite of Subscribe, e.g. sending Notifications.</p>
<h2 id="services-amp-adapters">Services &amp; Adapters</h2>
<p>You can use <code>Pho\Kernel\Kernel::service($service_id)</code> to reach a service. Currently standard services on Pho-Kernel are:</p>
<table>
<thead>
<tr>
<th>Service Type</th>
<th>Description</th>
<th>Base Adapter</th>
<th>Distributed Adapter</th>
<th>Cloud Adapter</th>
<th>Implements</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Database</strong></td>
<td>As a proof of truth and to store fundamental graph information.</td>
<td>APCU</td>
<td>Redis</td>
<td><del>DynamoDB</del></td>
<td>...</td>
</tr>
<tr>
<td><strong>Events</strong></td>
<td>To make the kernel more flexible with event-driven programming.</td>
<td>Local</td>
<td>ZeroMQ</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td><strong>Index</strong></td>
<td>To make search and database query easier and faster.</td>
<td>MySQL</td>
<td>ElasticSearch</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td><strong>Logger</strong></td>
<td>To log for errors or debug information.</td>
<td>Stdout or File</td>
<td>Scribe</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td><strong>Storage</strong></td>
<td>To store and retrieve plaintext or binary files such as photos, videos, zip files etc.</td>
<td>Filesystem</td>
<td>OpenStack Swift</td>
<td>AWS S3</td>
<td>..</td>
</tr>
</tbody>
</table>
<h2 id="working-with-events">Working with Events</h2>
<p>One of the best features of the Pho Kernel is that it is event-driven. Anytime a new node or edge is created, deleted, edited, a signal is emitted. If set, a listener object (a <a href="http://php.net/manual/en/language.types.callable.php">Callable</a>) can process the signal in real-time.</p>
<p>Available events are:</p>
<h4 id="graph">Graph</h4>
<ul>
<li><strong>node.added</strong>: when a new node is added to the graph.</li>
<li><strong>modified</strong>: when the graph is modified with a node addition or removal.</li>
</ul>
<h4 id="edge">Edge</h4>
<ul>
<li><strong>modified</strong>: when the edge is modified either by connecting or by its attribute bag.</li>
<li><strong>deleting</strong>: when the edge is being deleted.</li>
</ul>
<h4 id="subgraph">SubGraph</h4>
<ul>
<li><strong>modified</strong>: when the subgraph is modified by its attribute bag.</li>
<li><strong>edge.created</strong>: when there is a new edge originating from this subgraph.</li>
<li><strong>edge.connected</strong>: when the orphan edge of this subgraph is connected to a head.</li>
<li><strong>deleting</strong>: when the subgraph is being deleted.</li>
</ul>
<h4 id="node">Node</h4>
<ul>
<li><strong>modified</strong>: when the node is modified by its attribute bag.</li>
<li><strong>edge.created</strong>: when there is a new edge originating from this node.</li>
<li><strong>edge.connected</strong>: when the orphan edge of this node is connected to a head.</li>
<li><strong>deleting</strong>: when the node is being deleted.</li>
<li><strong>edge.registered</strong>: (string $direction, string $class): called by particles when registering edges. This function may be used extra edges easily and independently, without extending the constructor itself.</li>
<li><strong>notification.received</strong>: (AbstractNotification $notification): called when the actor received a notification. </li>
</ul>
<p>Example usage:</p>
<pre><code class="language-php">$node-&gt;on("modified", function() use ($node) {
    $node-&gt;persist();
});</code></pre>
<h2 id="acl-access-control-lists">ACL (Access Control Lists)</h2>
<p>Acl stands for &quot;access-control-lists&quot;. Pho handles access to nodes and graphs similarly to how UNIX handles access to files and folders, hence the name.</p>
<p>With Pho:</p>
<ul>
<li>a node is the UNIX equivalent of a file.</li>
<li>a graph is the UNIX equivalent of a directory.</li>
</ul>
<p>In terms of privileges;</p>
<ul>
<li>read remains the same for both.</li>
<li>write reamins the same for both.</li>
<li>UNIX' execute is Pho's subscribe.</li>
<li>In addition, Pho introduces the &quot;manage&quot; privilege.</li>
</ul>
<p>Due to this additional privilege (e.g. &quot;manage&quot;), Pho uses a hexadecimal system to manage privileges, in contrast to UNIX' octal.</p>
<p>Plus, in terms of privilege groups, Pho introduces an additional one, called &quot;subscribers&quot;:</p>
<ul>
<li>UNIX' u (users) remain the same. The u group is the owner of the object (or the actor itself, if it's an actor).</li>
<li>s (subscriber) is a new privilege group. It consists of all the subscribers of this node. The subscribers include the head nodes of any edge that extends the Subscribe edge. </li>
<li>g (graph) is same as UNIX' g (group). It is the group of actors that belong to the same context with the &quot;u&quot; of this node.</li>
<li>o (others) is same as UNIX' o. It is &quot;others&quot;, meaning actors that belong to graphs not included by the context that the &quot;u&quot; belongs to.</li>
</ul>
<p>Additionally, one can set up fine-grained privileges per actor and graph, using Pho's advanced access control lists, which is again, inspired by UNIX' access control lists, but slightly different.</p>
<p>Again, similarly to UNIX, Pho also has &quot;sticky-bit&quot; which ensures the privileges of an entity (or object) can only be changed by its owner, and not by the admins.</p>
<p>One can change a node's privileges with this simple command:</p>
<pre><code class="language-php">$node-&gt;acl()-&gt;chmod(0x1e741);</code></pre>
<p>where the parameter is (from left-to-right):</p>
<ul>
<li>0x: is PHP's hexadecimal declaration. So it must be there.</li>
<li>1: is the sticky bit. Similar to UNIX, it may be 0 or 1.</li>
<li>e: is the &quot;u&quot;. This gives the u &quot;manage&quot; privilege, in addition to &quot;read&quot;, &quot;write&quot; and &quot;subscribe&quot;. So it's 1(subscribe) + 2(write) + 4(read) + 8(manage) = 15(&quot;e&quot; in hexadecimal).</li>
<li>7: is the &quot;s&quot;. Subscribers can write to, read and subscribe to this node, but not manage it.</li>
<li>4: is the &quot;g&quot;. People in the same graph with this node.</li>
<li>1: is the &quot;o&quot; -- outsiders.</li>
</ul>
<p>So for example, if this $node was a group (like a Facebook Group), this means:</p>
<ul>
<li>Only the group owner can edit or assign new privileges.</li>
<li>The group managers can do anything, except, see above.</li>
<li>The members (subscribers) of this group can post (write) and read anything.</li>
<li>The people who are part of this network can read and subscribe the contents of this group, which means it's a read-only public one.</li>
<li>The outsiders can only see the description of ../. </li>
</ul>
<p>The permissions table is as follows;</p>
<table>
<thead>
<tr>
<th></th>
<th>Admin</th>
<th>Read</th>
<th>Write</th>
<th>Execute (Subscribe)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actor</td>
<td>Manage profile</td>
<td>See full profile.</td>
<td>Edit profile</td>
<td>Follow/become friends (or if friends already, react)</td>
</tr>
<tr>
<td>Object</td>
<td>Manage reactions</td>
<td>Read</td>
<td>Edit</td>
<td>Subscribe/<em>react</em></td>
</tr>
<tr>
<td>Graph</td>
<td>Moderate/profile</td>
<td>Read contents</td>
<td>Post content</td>
<td>Subscribe</td>
</tr>
</tbody>
</table>
<h2 id="reference">Reference</h2>
<p>For a full list of Phở Kernel classes and methods, refer to our PHPDocumentor auto-generated reference.</p>
                </section>

            </div>
        </main>

        <footer>
            <div class="container-fluid">
                <p class="text-muted">
                    website generated with <a href="http://couscous.io" title="Markdown website generator">Couscous</a>
                </p>
            </div>
        </footer>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="/js/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
